<table align="right">
 <tr><td><a href="README.md"><img src="https://github.com/ggwmwgg/ggwmwgg/blob/main/images/us.png" height="13" alt=""> English</a></td></tr>
 <tr><td><b><img src="https://github.com/ggwmwgg/ggwmwgg/blob/main/images/ru_s.png" height="13" alt=""> Русский</b></td></tr>
</table>
## Telegram Бот уведомлений на Aiogram

### Описание
Менеджер выгружает данные из файла Google Sheets ([Смотреть Пример](https://docs.google.com/spreadsheets/d/1vBHTh28dYkEt1_PDrR8PVa5tyzvFGb2ufEWTcnwzZy0/ "Пример")) в базу данных, сотруднику приходит уведомление с прикрепленной инлайн клавиатурой (Выполнено/Не сделано). Если сотрудник в течение answer_time не нажимает ни на одну из кнопок, они удаляются и менеджеру приходит соответствующее уведомление, если же сотрудник нажал на одну из кнопок - менеджеру приходит уведомление на какую именно, клавиатура также удаляется.
Было создано несколько обработчиков и функций:
- ```/start``` - Стартовая команда, которая добавляет пользователя в базу данных.
- ```/m_add TG_ID``` - Команда для добавления менеджера в базу данных.
- ```handlers/users/acl_test``` - Обработчик для работы команды выше.
- ```handlers/users/echo``` - Обработка неизвестных команд.
- ```handlers/users/start``` - Обработка основных запросов (регистрация, отправка даты менеджером, обработка нажатий на кнопки в уведомлении).
- ```data/config.py``` - Файл с конфигурацией, в котором хранятся данные для подключения к базе данных, Telegram API Token, а также ID администраторов.
- ```utils/db_api/db_api.py``` - Файл с функциями для работы с базой данных, проверкой последних уведомлений и их отправки.
- ```utils/db_api/models.py``` - Файл с моделями базы данных.
- ```utils/get_data.py``` - Файл с функцией, которая принимает ссылку и возвращает лист словарей для дальнейшего добавления в бд.
- ```utils/notify_admins.py``` - Файл с функцией, которая отправляет уведомление администратору.
- Также в боте присутствует флуд контроль.
- В функции удаления клавиатуры с уведомлений присутствует очистка от уже выполненных задач.

#### Используемые технологии:
- *Python*
- *Aiogram*
- *Asyncio*
- *Pandas*
- *Tortoise ORM*
- *PostgreSQL*
- *Docker*
- *Docker-compose*

#### Конфигурация:
- Установите свои данные для подключения к PostgreSQL и Telegram API Token в ```.env.dist```, переименуйте его в ```.env```.
- Установите свой Telegram ID в data/config.py на строчке 7.
- Установите свои данные для healthcheck-a в ```docker-compose.yml``` на строчке 23.
- Соберите контейнеры с помощью ```docker-compose build```.
- Запустите контейнеры с помощью ```docker-compose up```, вы можете добавить флаг ```-d``` для запуска в фоновом режиме.
- Для остановки контейнеров используйте ```docker-compose down```.

#### Использование:
- После установки себя администратором, в боте, после старта, напишите команду ```/m_add TG_ID``` где ```TG_ID``` это ID менеджера.
- Для загрузки данных следуйте инструкции и структуре, указанной в примерах.



#### Возможные улучшения:
Запросы на изменение приветствуются. Для внесения значительных изменений, пожалуйста, сначала создайте проблему, чтобы обсудить, что вы хотите изменить.

